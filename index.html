<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½›å­¦ç ”ä¹ ç¤¾ - æ™ºæ…§è¯åº“ç¨³å®šç‰ˆ</title>
    <style>
        :root { --bg: #f5f2ed; --sidebar-bg: #ffffff; --accent: #967d5a; --text: #2c2e2f; --border: #dcd7cc; }
        body, html { height: 100%; margin: 0; font-family: "PingFang SC", "Hiragino Sans GB", serif; background: var(--bg); color: var(--text); overflow: hidden; }
        .app-wrapper { display: flex; height: 100vh; }

        /* å·¦ä¾§åˆ—è¡¨ */
        .sidebar { width: 40%; border-right: 1px solid var(--border); display: flex; flex-direction: column; background: var(--sidebar-bg); }
        .sidebar-header { padding: 25px; background: var(--accent); color: white; }
        .sidebar-header h2 { margin: 0; font-weight: 300; letter-spacing: 4px; font-size: 1.2rem; }
        .term-list { flex: 1; overflow-y: auto; }
        .term-item { border-bottom: 1px solid #f0eee9; }
        .term-header { padding: 18px 25px; cursor: pointer; display: flex; justify-content: space-between; align-items: center; background: #fff; }
        .term-header:hover { background: #fdfaf5; }
        .term-content { max-height: 0; overflow: hidden; transition: max-height 0.4s ease-out; background: #fbfaf8; }
        .term-item.active .term-content { max-height: 1200px; border-bottom: 2px solid var(--accent); }

        /* è¯¦æƒ…æ ·å¼ */
        .detail-body { padding: 15px 25px 25px; font-size: 0.95rem; line-height: 1.8; }
        .label { font-weight: bold; color: var(--accent); display: block; margin-top: 10px; font-size: 0.85rem; border-bottom: 1px solid #eee; }
        .text-quote { font-style: italic; color: #555; background: #f9f7f2; padding: 10px; border-left: 3px solid var(--accent); margin: 5px 0; }
        .text-prac { background: #f2efea; padding: 12px; border-radius: 4px; margin-top: 5px; }

        /* å³ä¾§å¯¹è¯åŒº */
        .chat-container { flex: 1; display: flex; flex-direction: column; background: #eeebdf; }
        #chat-window { flex: 1; overflow-y: auto; padding: 25px; display: flex; flex-direction: column; gap: 20px; }
        .message { max-width: 85%; padding: 15px 20px; border-radius: 12px; position: relative; box-shadow: 0 2px 10px rgba(0,0,0,0.05); line-height: 1.6; }
        .user-msg { align-self: flex-end; background: var(--accent); color: white; border-bottom-right-radius: 2px; }
        .gemini-msg { align-self: flex-start; background: white; border: 1px solid var(--border); border-bottom-left-radius: 2px; white-space: pre-wrap; padding-bottom: 40px; }

        /* å½•å…¥æŒ‰é’® */
        .entry-trigger { position: absolute; bottom: 8px; right: 12px; background: var(--accent); color: white; border: none; padding: 4px 10px; border-radius: 4px; cursor: pointer; font-size: 12px; opacity: 0.8; }
        .entry-trigger:hover { opacity: 1; }

        .input-area { padding: 20px; background: white; border-top: 1px solid var(--border); display: flex; flex-direction: column; gap: 10px; }
        textarea#userInput { width: 100%; height: 70px; padding: 12px; border: 1px solid var(--border); border-radius: 8px; resize: none; box-sizing: border-box; font-family: inherit; font-size: 14px; }
        .send-btn { align-self: flex-end; padding: 8px 30px; background: var(--accent); color: white; border: none; border-radius: 5px; cursor: pointer; }

        /* Modal å¼¹çª— */
        .modal-overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); z-index: 1000; justify-content: center; align-items: center; }
        .modal { background: white; padding: 25px; border-radius: 12px; width: 500px; display: flex; flex-direction: column; gap: 12px; box-shadow: 0 10px 30px rgba(0,0,0,0.3); }
        .modal h3 { margin: 0; color: var(--accent); }
        .modal input, .modal textarea { padding: 10px; border: 1px solid var(--border); border-radius: 4px; font-family: inherit; width: 100%; box-sizing: border-box; }
        .modal-btns { display: flex; justify-content: flex-end; gap: 10px; margin-top: 10px; }
        .btn-close { background: #eee; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; }
        .btn-add { background: var(--accent); color: white; border: none; padding: 8px 15px; border-radius: 4px; cursor: pointer; }
    </style>
</head>
<body>

<div class="app-wrapper">
    <div class="sidebar">
        <div class="sidebar-header">
            <h2>ä½›å­¦ç§è—è¯åº“</h2>
            <div id="count" style="font-size: 12px; opacity: 0.9; margin-top:5px">è½½å…¥ä¸­...</div>
        </div>
        <div class="term-list" id="termList"></div>
    </div>

    <div class="chat-container">
        <div id="chat-window">
            <div class="message gemini-msg">å°Šè€…æ‚¨å¥½ã€‚è¯·ç›´æ¥è¾“å…¥æ‚¨æƒ³ç ”ä¹ çš„æ¦‚å¿µã€‚
æˆ‘ä¼šè‡ªåŠ¨ä¸ºæ‚¨æ•´ç†ã€‚ç‚¹å‡»å›ç­”ä¸‹æ–¹çš„â€œğŸ“¥ å½•å…¥â€å¯æ‰‹åŠ¨å­˜å…¥è¯åº“ã€‚</div>
        </div>
        <div class="input-area">
            <textarea id="userInput" placeholder="è¯·è¾“å…¥æ¦‚å¿µ..."></textarea>
            <button class="send-btn" onclick="askGemini()">æé—®</button>
        </div>
    </div>
</div>

<div class="modal-overlay" id="entryModal">
    <div class="modal">
        <h3>ç”Ÿæˆæ–°è¯æ¡</h3>
        <input type="text" id="in-t" placeholder="è¯æ¡åç§° (å¦‚: 51. å››åœ£è°›)">
        <textarea id="in-q" placeholder="ã€çŸ­å¼•ã€‘"></textarea>
        <textarea id="in-e" placeholder="ã€è§£é‡Šã€‘" style="height:80px"></textarea>
        <textarea id="in-m" placeholder="ã€å¸¸è§è¯¯è§£ã€‘"></textarea>
        <textarea id="in-p" placeholder="ã€ä¿®æŒæç¤ºã€‘"></textarea>
        <div class="modal-btns">
            <button class="btn-close" onclick="closeModal()">å–æ¶ˆ</button>
            <button class="btn-add" onclick="saveEntry()">ä¿å­˜</button>
        </div>
    </div>
</div>

<script>
    const API_KEY = "AIzaSyB5FyPB_XW5-2f98p12WFqI1je5H5WmDyg";

    // ä¸¥è°¨çš„æ•°æ®æ•°ç»„
    let myTerms = [
        {t:"1) ä¸­é˜´", q:"â€œè¯¸è¡Œæ— å¸¸ã€‚â€", e:"ç”Ÿå‘½çŠ¶æ€è½¬æ¢çš„ç¼éš™ï¼Œå¦‚ç”Ÿæ­»ä¹‹é—´ã€‚", m:"å½“åšææ€–ä¼ è¯´ã€‚", p:"ç»ƒä¹ åœ¨æƒ…ç»ªçªå‘æ—¶ä¿æŒè§‰çŸ¥ã€‚"},
        {t:"2) äº”è•´", q:"â€œç…§è§äº”è•´çš†ç©ºã€‚â€", e:"è‰²å—æƒ³è¡Œè¯†äº”ç§èº«å¿ƒèšåˆã€‚", m:"ä»¥ä¸ºæœ‰ä¸ªæ°¸æ’çš„â€˜è¯†â€™ã€‚", p:"è§‚å¯Ÿæƒ…ç»ªå¦‚ä½•ç”±â€˜å—â€™è½¬ä¸ºâ€˜æƒ³â€™ã€‚"},
        {t:"3) å…­æ ¹", q:"â€œæ‘„æŠ¤è¯¸æ ¹ã€‚â€", e:"çœ¼è€³é¼»èˆŒèº«æ„å…­ç§æ„Ÿå®˜åŠŸèƒ½ã€‚", m:"è¦æŠŠæ„Ÿå®˜å¼ºè¡Œå…³æ‰ã€‚", p:"ç»ƒâ€˜çœ‹è§åªæ˜¯çœ‹è§â€™ã€‚"},
        {t:"4) å…­å°˜", q:"â€œåº”æ— æ‰€ä½ã€‚â€", e:"è‰²å£°é¦™å‘³è§¦æ³•å…­ç§å¤–åœ¨å¯¹è±¡ã€‚", m:"ä»¥ä¸ºå¤–å¢ƒæ˜¯è‚®è„çš„ã€‚", p:"åœ¨è¯±æƒ‘é¢å‰è§‚å¯Ÿå¿ƒçš„èµ·ä¼ã€‚"},
        {t:"5) å…­è¯†", q:"â€œä¸€åˆ‡å”¯å¿ƒé€ ã€‚â€", e:"æ ¹å°˜æ¥è§¦åäº§ç”Ÿçš„äº†åˆ«åŠŸèƒ½ã€‚", m:"æŠŠè¯†å½“æˆçœŸæˆ‘ã€‚", p:"å†²çªæ—¶è§‰å¯Ÿæ„è¯†çš„åè§ã€‚"},
        {t:"6) ä¸‰å®", q:"â€œå½’ä¾ä½›æ³•åƒ§ã€‚â€", e:"ä½›ã€æ³•ã€åƒ§ï¼Œè§‰æ‚Ÿçš„å¯¼å¸ˆã€è·¯å¾„ä¸ä¼™ä¼´ã€‚", m:"å½“æˆå¤–åœ¨ç¥çµå´‡æ‹œã€‚", p:"æ¯æ—¥è‡ªçœæ˜¯å¦èƒŒç¦»è§‰é†’ã€‚"},
        {t:"7) çšˆä¾", q:"â€œè‡ªå‡€å…¶æ„ã€‚â€", e:"ç¡®ç«‹äººç”Ÿä»¥è§‰é†’ä¸ºå”¯ä¸€çš„æ–¹å‘ã€‚", m:"å½“æˆå…¥æ•™ä»ªå¼ã€‚", p:"é‡åˆ°çƒ¦èºå…ˆå›æƒ³çšˆä¾çš„åˆå¿ƒã€‚"},
        {t:"8) ç©ºæ€§", q:"â€œè‰²å³æ˜¯ç©ºã€‚â€", e:"ä¸‡æ³•ä¾ç¼˜è€Œç”Ÿï¼Œæ²¡æœ‰å›ºå®šæ°¸æ’çš„æœ¬æ€§ã€‚", m:"ç©ºå°±æ˜¯ä»€ä¹ˆéƒ½æ²¡æœ‰ã€‚", p:"æ‰§ç€æ—¶é—®ï¼šå®ƒä¾èµ–ä»€ä¹ˆå­˜åœ¨ï¼Ÿ"},
        {t:"9) ç¼˜èµ·", q:"â€œæ­¤æœ‰æ•…å½¼æœ‰ã€‚â€", e:"ä¸€åˆ‡äº‹ç‰©éƒ½æ˜¯æ¡ä»¶çš„ç»„åˆã€‚", m:"å®¿å‘½è®ºæˆ–å¶ç„¶è®ºã€‚", p:"ä»ç¡çœ ã€é¥®é£Ÿè§‚å¯Ÿèº«ä½“çš„ç¼˜èµ·ã€‚"},
        {t:"10) æ— å¸¸", q:"â€œè¯¸è¡Œæ— å¸¸ã€‚â€", e:"äº‹ç‰©æ—¶åˆ»åœ¨å˜è¿ã€‚ç²—ä¸ºç”Ÿç­ï¼Œç»†ä¸ºåˆ¹é‚£ã€‚", m:"æ„Ÿåˆ°æ¶ˆæåŒä¸–ã€‚", p:"çæƒœå½“ä¸‹çš„æ¯ä¸€ä¸ªå› ç¼˜ã€‚"},
        {t:"11) æ— æˆ‘", q:"â€œè¯¸æ³•æ— æˆ‘ã€‚â€", e:"æ²¡æœ‰ä¸€ä¸ªä¸»å®°ä¸€åˆ‡ã€æ°¸æ’ä¸å˜çš„æˆ‘ã€‚", m:"å¦å®šè´£ä»»ä¸å› æœã€‚", p:"åˆ†è§£â€˜æˆ‘æ…¢â€™ï¼šè¿™æ˜¯æƒ³æ³•è¿˜æ˜¯äº‹å®ï¼Ÿ"},
        {t:"12) è‹¦è°›", q:"â€œè¯¸è¡Œçš†è‹¦ã€‚â€", e:"ä¸åœ†æ»¡ã€ä¸å®‰ç¨³çš„æœ¬è´¨ã€‚", m:"ä½›æ•™æ˜¯è‹¦éš¾çš„å®—æ•™ã€‚", p:"è§‚å¯Ÿâ€˜ä¹â€™èƒŒåçš„ä¸å®‰ç¨³æ€§ã€‚"},
        {t:"13) å››åœ£è°›", q:"â€œçŸ¥è‹¦æ–­é›†ã€‚â€", e:"è‹¦ã€é›†ã€ç­ã€é“ï¼Œè§£è„±çš„å››ä¸ªé˜¶æ®µã€‚", m:"åªæ˜¯å“²å­¦ç†è®ºã€‚", p:"é‡äº‹æŒ‰â€˜è¿™å‘ç”Ÿäº†ä»€ä¹ˆ-å› åœ¨å“ª-èƒ½åœå—-æ€ä¹ˆåšâ€™åˆ†æã€‚"},
        {t:"14) å…«æ­£é“", e:"æ­£è§ã€æ­£æ€æƒŸã€æ­£è¯­ã€æ­£ä¸šã€æ­£å‘½ã€æ­£ç²¾è¿›ã€æ­£å¿µã€æ­£å®šã€‚", m:"é“å¾·æ•™æ¡ã€‚", p:"ä»Šæ—¥ä¿®è¡Œï¼šä¸è¯´åˆ»è–„è¯ã€‚"},
        {t:"15) ä¸‰å­¦", e:"æˆ’ã€å®šã€æ…§ï¼Œä¿®è¡Œçš„æ€»çº²ã€‚", m:"å‰²è£‚ä¿®è¡Œï¼Œåªæ±‚æ…§ä¸ä¿®æˆ’ã€‚", p:"ç”Ÿæ´»é™å™ªï¼ˆæˆ’ï¼‰ï¼Œå¿ƒå¿µå®‰ä½ï¼ˆå®šï¼‰ã€‚"},
        {t:"16) æˆ’å¾‹", e:"é˜²éæ­¢æ¶çš„è§„èŒƒã€‚", m:"æŸç¼šè‡ªç”±ã€‚", p:"å®ˆå£ä¸šï¼Œä¸è¯„ä»·ä»–äººæ˜¯éã€‚"},
        {t:"17) ç¦…å®š", e:"å¿ƒçš„ä¸“æ³¨ä¸å®é™çŠ¶æ€ã€‚", m:"å‘å‘†æˆ–ç¥é€šã€‚", p:"æ¯æ—¥10åˆ†é’Ÿæ•°æ¯è§‚ã€‚"},
        {t:"18) æ™ºæ…§", e:"ç…§è§çœŸç›¸çš„èƒ½åŠ›ã€‚", m:"èªæ˜æ‰æ™ºã€‚", p:"åœ¨çƒ¦æ¼ä¸­å¯»æ‰¾å®ƒçš„ç©ºæ€§ã€‚"},
        {t:"19) æ­¢", e:"æ­¢æ¯æ•£ä¹±ï¼Œä¸“æ³¨æ‰€ç¼˜ã€‚", m:"å‹æŠ‘å¿µå¤´ã€‚", p:"å‘¼å¸æ•£ä¹±æ—¶è½»æŸ”å¸¦å›ã€‚"},
        {t:"20) è§‚", e:"å¦‚å®è§‚å¯Ÿç”Ÿç­è¿‡ç¨‹ã€‚", m:"èƒ¡æ€ä¹±æƒ³ã€‚", p:"è§‚å¯Ÿèº«ä½“è§¦æ„Ÿçš„ç”Ÿèµ·å’Œæ¶ˆå¤±ã€‚"},
        {t:"21) å››å¿µå¤„", e:"è§‚èº«ã€è§‚å—ã€è§‚å¿ƒã€è§‚æ³•ã€‚", m:"æ”¾ç©ºå¤§è„‘ã€‚", p:"èµ°è·¯æ—¶åªæ„ŸçŸ¥è„šåº•è§¦åœ°ã€‚"},
        {t:"22) æ­£å¿µ", e:"ä¸å¿˜å¤±å½“ä¸‹ï¼Œæ˜äº†è§‰çŸ¥ã€‚", m:"ç­‰äºæ”¾æ¾ã€‚", p:"åƒé¥­æ—¶æ”¾ä¸‹æ‰‹æœºï¼Œæ„ŸçŸ¥é£Ÿç‰©ã€‚"},
        {t:"23) ä¸‰æ³•å°", e:"æ— å¸¸ã€æ— æˆ‘ã€æ¶…æ§ƒå¯‚é™ã€‚", m:"å£å¤´ç¦…ã€‚", p:"ç”¨â€˜è¿™ä¼šå˜å—â€™æ£€éªŒä¸€åˆ‡ã€‚"},
        {t:"24) äºŒè°›", e:"ä¸–ä¿—è°›ä¸èƒœä¹‰è°›ã€‚", m:"äº’ç›¸çŸ›ç›¾ã€‚", p:"è´Ÿè´£ä»»åœ°åšäº‹ï¼Œä¸æ‰§ç€åœ°çœ‹æœã€‚"},
        {t:"25) ä¸­é“", e:"ç¦»ä¸¤è¾¹ï¼Œä¸å •å¸¸æ–­ã€‚", m:"å„æ‰“äº”åå¤§æ¿çš„æŠ˜ä¸­ã€‚", p:"æ—¢ä¸è´ªæ±‚ï¼Œä¹Ÿä¸å¼ºè¡Œå‹åˆ¶ã€‚"},
        {t:"26) åäºŒå› ç¼˜", e:"ç”Ÿå‘½æµè½¬çš„åäºŒä¸ªç¯èŠ‚ã€‚", m:"è¿‡å»ä¸–çš„ä¼ è¯´ã€‚", p:"è§‚å¯Ÿâ€˜è§¦â€™å¦‚ä½•æ¼”å˜æˆâ€˜çˆ±â€™ã€‚"},
        {t:"27) ä¸šåŠ›", e:"èº«å£æ„çš„é€ ä½œåŠå…¶æƒ¯æ€§ã€‚", m:"ä¸Šå¤©çš„æƒ©ç½šã€‚", p:"ä¿®æ”¹ä¸€ä¸ªå°ä¹ æƒ¯ï¼Œå°±æ˜¯è½¬ä¸šã€‚"},
        {t:"28) è½®å›", e:"æƒ¯æ€§æ¨¡å¼çš„æ­»å¾ªç¯ã€‚", m:"åªæœ‰æ­»åæ‰æœ‰ã€‚", p:"è§‚å¯Ÿè‡ªå·±æ¯å¤©é‡å¤çš„è´Ÿé¢å¿µå¤´ã€‚"},
        {t:"29) å‡ºç¦»å¿ƒ", e:"ä¸å†å¯»æ‰¾è™šå‡å®‰ç¨³çš„å†³å¿ƒã€‚", m:"é€ƒç¦»ç¤¾ä¼šã€‚", p:"çœ‹åˆ°ååˆ©èƒŒåçš„è¡Œè‹¦ã€‚"},
        {t:"30) æ¶…æ§ƒ", e:"ç†„ç­çƒ¦æ¼çš„æ¸…å‡‰å¢ƒç•Œã€‚", m:"æŒ‡ä»£æ­»äº¡ã€‚", p:"å—”å¿ƒåœæ¯çš„ç¬é—´å°±æ˜¯å°æ¶…æ§ƒã€‚"},
        {t:"31) çƒ¦æ¼", e:"æŸ“æ±¡å¿ƒæ€§çš„å¿ƒç†å› ç´ ã€‚", m:"æ•Œäººã€‚", p:"çœ‹ç€å®ƒï¼Œä¸è·Ÿéšã€‚"},
        {t:"32) è´ª", e:"å¯¹å¯çˆ±å¢ƒçš„ç—…æ€æŠ“å–ã€‚", m:"æ­£å½“éœ€æ±‚ä¹Ÿæ˜¯è´ªã€‚", p:"ä¹°ä¸œè¥¿å‰ç­‰ä¸‰åˆ†é’Ÿã€‚"},
        {t:"33) å—”", e:"å¯¹ä¸å¯çˆ±å¢ƒçš„æ•Œè§†ã€‚", m:"è‡ªä»¥ä¸ºæ­£ä¹‰ã€‚", p:"ç«èµ·æ—¶å…ˆæ·±å‘¼å¸ä¸‰æ¬¡ã€‚"},
        {t:"34) ç—´", e:"ä¸æ˜å› æœã€ä¸æ˜çœŸç›¸ã€‚", m:"æ™ºå•†ä½ã€‚", p:"è§‚å› ç¼˜ï¼Œç ´é™¤ç†æ‰€å½“ç„¶ã€‚"},
        {t:"35) æ…¢", e:"æ¯”è¾ƒä¸­çš„è‡ªæˆ‘è†¨èƒ€ã€‚", m:"åªæœ‰å‚²æ…¢ã€‚", p:"éšå–œä»–äººçš„æˆåŠŸã€‚"},
        {t:"36) ç–‘", e:"å¯¹æ­£æ³•çš„çŠ¹è±«ä¸å†³ã€‚", m:"ä¸èƒ½æé—®ã€‚", p:"å¸¦ç€ç–‘é—®å»å®è·µï¼Œè€Œéç©ºæƒ³ã€‚"},
        {t:"37) ä¿¡", e:"å¯¹è§‰æ‚Ÿå¯èƒ½æ€§çš„ç¡®ä¿¡ã€‚", m:"ç›²ä»ã€‚", p:"ä»å¾®å°çš„ä¿®è¡Œåé¦ˆä¸­å»ºç«‹ä¿¡å¿ƒã€‚"},
        {t:"38) ç²¾è¿›", e:"å‘ä¸Šå‘å–„çš„æŒä¹…åŠ¨åŠ›ã€‚", m:"ç”¨åŠ›è¿‡çŒ›ã€‚", p:"ç»†æ°´é•¿æµçš„æ¯æ—¥åŠŸè¯¾ã€‚"},
        {t:"39) å¿è¾±", e:"åœ¨é€†å¢ƒä¸­ä¸ç”Ÿå—”å¿ƒã€‚", m:"èƒ†å°æ€•äº‹ã€‚", p:"é¢å¯¹æ‰¹è¯„æ—¶ä¸æ€¥äºè¾©è§£ã€‚"},
        {t:"40) å¸ƒæ–½", e:"èˆå¼ƒæŠ“å–ï¼Œåˆ©ä»–ã€‚", m:"èŠ±é’±ä¹°åŠŸå¾·ã€‚", p:"ç»™ä»–äººä¸€ä¸ªå¾®ç¬‘ã€‚"},
        {t:"41) æŒæˆ’", e:"æ¸…å‡€ç”Ÿæ´»çš„åŸºçŸ³ã€‚", m:"å¤–åœ¨æ·é”ã€‚", p:"ä¿æŠ¤ä»–äººçš„å®‰å…¨æ„Ÿã€‚"},
        {t:"42) ç¦…å®š", e:"å¿ƒçš„ä¸€å¢ƒæ€§ã€‚", m:"è¿½æ±‚å¢ƒç•Œã€‚", p:"åœ¨æ•£ä¹±ä¸­è®¤å‡ºæ•£ä¹±ã€‚"},
        {t:"43) èˆ¬è‹¥", e:"å½»åº•çš„è§‰é†’æ™ºæ…§ã€‚", m:"å“²å­¦çŸ¥è¯†ã€‚", p:"çœ‹é€â€˜æˆ‘â€™çš„è™šå¹»ã€‚"},
        {t:"44) è©æå¿ƒ", e:"ä¸ºåˆ©æœ‰æƒ…æ„¿æˆä½›ã€‚", m:"ä¸€å¥å£å·ã€‚", p:"æ‰©å®½å¿ƒé‡ï¼Œä¸å†åªé¡¾å°æˆ‘ã€‚"},
        {t:"45) æ…ˆ", e:"æ„¿ä¼—ç”Ÿå¾—ä¹ã€‚", m:"æººçˆ±ã€‚", p:"ç¥æ„¿è®¨åŒçš„äººä¹Ÿè·å¾—å¹³é™ã€‚"},
        {t:"46) æ‚²", e:"æ„¿ä¼—ç”Ÿç¦»è‹¦ã€‚", m:"åŒæƒ…å¿ƒã€‚", p:"åŠ›æ‰€èƒ½åŠåœ°å¸®åŠ©å¼±å°ã€‚"},
        {t:"47) å–œ", e:"è§ä»–äººå¥½ç”Ÿæ¬¢å–œã€‚", m:"å®¢å¥—è¯ã€‚", p:"çœŸå¿ƒå¤¸å¥–ç«äº‰å¯¹æ‰‹ã€‚"},
        {t:"48) èˆ", e:"å¹³ç­‰å¿ƒï¼Œæ— åˆ†åˆ«ã€‚", m:"å†·æ¼ æ— æƒ…ã€‚", p:"ä¸åˆ†äº²ç–åœ°æ–½äºˆå–„æ„ã€‚"},
        {t:"49) å›å‘", e:"æ‰©å¤§åŠŸå¾·çš„å¿ƒé‡ã€‚", m:"è½¬è´¦è¡Œä¸ºã€‚", p:"åŠŸæˆä¸å±…ã€‚"},
        {t:"50) å¿æ‚”", e:"æ¸…å‡€è¿‡å¾€çš„æŸ“æ±¡ã€‚", m:"æ²‰æººè‡ªè´£ã€‚", p:"æ‰¿è®¤é”™è¯¯ï¼Œç«‹èª“ä¸äºŒè¿‡ã€‚"}
    ];

    function renderList() {
        const list = document.getElementById('termList');
        list.innerHTML = '';
        myTerms.forEach((item, idx) => {
            const div = document.createElement('div');
            div.className = 'term-item';
            div.innerHTML = `
                <div class="term-header" onclick="toggleItem(this)">
                    <h3>${item.t}</h3><span>â–¼</span>
                </div>
                <div class="term-content">
                    <div class="detail-body">
                        ${item.q ? `<span class="label">ã€çŸ­å¼•ã€‘</span><div class="text-quote">${item.q}</div>` : ''}
                        <span class="label">ã€è§£é‡Šã€‘</span><div>${item.e}</div>
                        ${item.m ? `<span class="label">ã€å¸¸è§è¯¯è§£ã€‘</span><div style="color:#8a6d6d">${item.m}</div>` : ''}
                        ${item.p ? `<span class="label">ã€ä¿®æŒæç¤ºã€‘</span><div class="text-prac">${item.p}</div>` : ''}
                    </div>
                </div>`;
            list.appendChild(div);
        });
        document.getElementById('count').innerText = `å·²å½•å…¥ ${myTerms.length} ä¸ªè¯æ¡`;
    }

    function toggleItem(header) {
        const item = header.parentElement;
        const active = item.classList.contains('active');
        document.querySelectorAll('.term-item').forEach(el => el.classList.remove('active'));
        if (!active) item.classList.add('active');
    }

    async function askGemini() {
        const input = document.getElementById('userInput');
        const text = input.value.trim();
        if (!text) return;

        appendMsg('user', text);
        input.value = '';

        const prompt = `ä½ æ˜¯ä¸€ä¸ªä½›å­¦ä¸“å®¶ã€‚è¯·è§£é‡Šâ€œ${text}â€ã€‚æŒ‰ä»¥ä¸‹å››æ¿å—å›å¤ï¼š1.çŸ­å¼• 2.è§£é‡Š 3.å¸¸è§è¯¯è§£ 4.ä¿®æŒæç¤ºã€‚`;

        try {
            const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${AIzaSyB5FyPB_XW5-2f98p12WFqI1je5H5WmDyg}`, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });
            const data = await res.json();
            const reply = data.candidates[0].content.parts[0].text;
            appendMsg('gemini', reply);
        } catch (e) {
            appendMsg('gemini', "è¿æ¥è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ– API Keyã€‚\næ‚¨å¯ä»¥æ‰‹åŠ¨ç‚¹å‡»å³ä¾§æŒ‰é’®è¿›è¡Œå½•å…¥ã€‚");
        }
    }

    function appendMsg(role, text) {
        const win = document.getElementById('chat-window');
        const div = document.createElement('div');
        div.className = `message ${role}-msg`;
        div.innerText = text;

        if (role === 'gemini') {
            const btn = document.createElement('button');
            btn.className = 'entry-trigger';
            btn.innerHTML = 'ğŸ“¥ å½•å…¥';
            btn.onclick = () => openModal();
            div.appendChild(btn);
        }

        win.appendChild(div);
        win.scrollTop = win.scrollHeight;
    }

    function openModal() {
        document.getElementById('entryModal').style.display = 'flex';
    }

    function closeModal() {
        document.getElementById('entryModal').style.display = 'none';
    }

    function saveEntry() {
        const t = document.getElementById('in-t').value;
        if (!t) { alert("è¯æ¡åç§°ä¸èƒ½ä¸ºç©º"); return; }

        const newItem = {
            t: t,
            q: document.getElementById('in-q').value,
            e: document.getElementById('in-e').value,
            m: document.getElementById('in-m').value,
            p: document.getElementById('in-p').value
        };

        myTerms.unshift(newItem);
        renderList();
        closeModal();
        
        // é‡ç½®
        ['in-t','in-q','in-e','in-m','in-p'].forEach(id => document.getElementById(id).value = '');
    }

    // åˆå§‹åŒ–è¿è¡Œ
    window.onload = renderList;
</script>
</body>
</html>
